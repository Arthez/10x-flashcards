---
const pathname = new URL(Astro.request.url).pathname;
---

<nav class="border-b">
  <div class="container mx-auto px-4 flex h-16 items-center justify-between">
    <div class="flex gap-6">
      <a
        href="/learn"
        class={`text-sm font-medium transition-colors hover:text-primary ${pathname === "/learn" ? "text-primary" : "text-muted-foreground"}`}
      >
        Learn
      </a>
      <a
        href="/browse"
        class={`text-sm font-medium transition-colors hover:text-primary ${pathname === "/browse" ? "text-primary" : "text-muted-foreground"}`}
      >
        Browse
      </a>
      <a
        href="/add"
        class={`text-sm font-medium transition-colors hover:text-primary ${pathname === "/add" ? "text-primary" : "text-muted-foreground"}`}
        aria-current={pathname === "/add" ? "page" : undefined}
      >
        Add
      </a>
      <a
        href="/generate"
        class={`text-sm font-medium transition-colors hover:text-primary ${pathname === "/generate" ? "text-primary" : "text-muted-foreground"}`}
      >
        Generate
      </a>
    </div>
    <button id="logout-button" class="text-sm font-medium text-muted-foreground hover:text-primary transition-colors">
      Logout
    </button>
  </div>
</nav>

<script is:inline>
  document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("logout-button").addEventListener("click", async () => {
      try {
        const response = await fetch("/api/auth/logout", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
        });

        if (!response.ok) {
          const data = await response.json();
          throw new Error(data.error || "Logout failed");
        }

        window.location.href = "/auth/login";
      } catch (error) {
        console.error("Logout failed:", error);
      }
    });
  });
</script>
